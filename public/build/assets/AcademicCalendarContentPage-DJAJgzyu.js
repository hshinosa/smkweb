import{j as e}from"./markdown-vendor-CIGiOj7E.js";import{r as d,S as U,f as m}from"./inertia-vendor-CFsdYvsV.js";import{M as B}from"./Modal-rJC0U0UH.js";import{T as g}from"./TextInput-DXlIWAoE.js";import{I as x}from"./InputLabel-B7Cy73bq.js";import{I as j}from"./InputError-CW7Z9Fko.js";import{P as b}from"./PrimaryButton-BP4GzKQS.js";import{S as J}from"./SecondaryButton-DgUeLkam.js";import{F as q}from"./FileUploadField-DGzk2RBu.js";import{C as H}from"./ContentManagementPage-CS4dHDNy.js";import{z as _}from"./app-SCjtbprB.js";import{b as L,c as R,d as $,P as W,T as Y,S as O,e as V}from"./ui-vendor-DKvpuSCb.js";import"./react-vendor-X_fu8xpB.js";import"./transition-CiB-21bZ.js";import"./index-CjLAxSrQ.js";import"./typography-ChUjANkt.js";import"./AdminLayout-BYuG-4eb.js";function pe({contents:s,filters:S}){const[C,y]=d.useState(!1),[h,f]=d.useState(null),[k,F]=d.useState(S.search||""),[n,u]=d.useState(null),[A,c]=d.useState(""),[P,K]=d.useState("list"),{data:t,setData:l,post:Q,processing:N,errors:o,reset:v}=U({title:"",calendar_image:null,semester:1,academic_year_start:new Date().getFullYear(),sort_order:0}),T=[{key:"list",label:"Kalender Akademik",description:"Kelola jadwal kegiatan akademik sekolah.",icon:L}],w=()=>{v(),f(null),u(null),c(""),y(!0)},M=a=>{l({title:a.title,calendar_image:null,semester:a.semester,academic_year_start:a.academic_year_start,sort_order:a.sort_order}),f(a),u(null),c(a.calendar_imagesImage?.original_url||a.calendar_image_url||""),y(!0)},p=()=>{y(!1),f(null),u(null),c(""),v()},G=a=>{if(a&&a.preventDefault(),n instanceof File){const z=["image/jpeg","image/jpg","image/png","image/gif","image/webp"];if(n.size>10485760){_.error("Ukuran gambar kalender maksimal 10MB");return}if(!z.includes(n.type)){_.error("Format gambar harus JPG, PNG, GIF, atau WebP");return}}const r={title:t.title,semester:t.semester,academic_year_start:t.academic_year_start,sort_order:t.sort_order};n&&(r.calendar_image=n),h?(r._method="PUT",m.post(route("admin.academic-calendar.update",h.id),r,{forceFormData:!0,onSuccess:()=>{p()},onError:i=>{console.error("Update errors:",i)}})):m.post(route("admin.academic-calendar.store"),r,{forceFormData:!0,onSuccess:()=>{p()},onError:i=>{console.error("Store errors:",i)}})},I=a=>{confirm(`Apakah Anda yakin ingin menghapus kalender "${a.title}"? Tindakan ini tidak dapat dibatalkan.`)&&m.delete(route("admin.academic-calendar.destroy",a.id))},E=a=>{m.patch(route("admin.academic-calendar.set-active",a.id))},D=a=>{a&&a.preventDefault(),m.get(route("admin.academic-calendar.index"),{search:k},{preserveState:!0,preserveScroll:!0})};return e.jsxs(H,{headerTitle:"Kelola Kalender Akademik",headTitle:"Kelola Kalender",tabs:T,activeTab:P,setActiveTab:K,extraHeader:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white p-4 rounded-xl shadow-sm border border-gray-100 mb-6",children:[e.jsxs("form",{onSubmit:D,className:"flex-1 flex gap-2 w-full",children:[e.jsx(g,{type:"text",value:k,onChange:a=>F(a.target.value),placeholder:"Cari berdasarkan judul, deskripsi, atau tahun akademik...",className:"flex-1"}),e.jsxs(b,{type:"submit",className:"flex items-center gap-2 !bg-accent-yellow !text-gray-900 hover:!bg-yellow-500 shadow-sm",children:[e.jsx(O,{size:16}),"Cari"]})]}),e.jsxs(b,{onClick:w,className:"flex items-center gap-2 !bg-accent-yellow !text-gray-900 hover:!bg-yellow-500 shadow-sm whitespace-nowrap",children:[e.jsx(V,{size:16}),"Tambah Kalender"]})]}),children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-2/5",children:"Kalender Akademik"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/6",children:"Semester & Tahun"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/12 text-center",children:"Status"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/12",children:"Urutan"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/6",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.data.length>0?s.data.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-12 w-12",children:e.jsx("img",{className:"h-12 w-12 rounded object-cover border",src:a.calendar_imagesImage?.original_url||a.calendar_image_url,alt:a.title,onError:r=>{r.target.src="https://placehold.co/48x48/E5E7EB/9CA3AF?text=IMG"}})}),e.jsxs("div",{className:"ml-3 min-w-0 flex-1",children:["                                                            ",e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:a.title})]})]})}),e.jsx("td",{className:"px-3 py-4 text-sm text-gray-900",children:e.jsxs("div",{className:"flex flex-col",children:["                                                        ",e.jsx("span",{className:"font-medium",children:a.semester===1?"Semester Ganjil":"Semester Genap"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[a.academic_year_start,"/",a.academic_year_start+1]})]})}),e.jsx("td",{className:"px-3 py-4 text-sm text-center",children:e.jsx("button",{onClick:()=>E(a),className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-bold transition-colors ${a.is_active?"bg-green-100 text-green-700 hover:bg-green-200":"bg-red-100 text-red-700 hover:bg-red-200"}`,title:a.is_active?"Klik untuk nonaktifkan":"Klik untuk aktifkan",children:a.is_active?e.jsxs(e.Fragment,{children:[e.jsx(R,{size:12})," Aktif"]}):e.jsxs(e.Fragment,{children:[e.jsx($,{size:12})," Nonaktif"]})})}),e.jsx("td",{className:"px-3 py-4 text-sm text-gray-900 text-center",children:a.sort_order}),e.jsx("td",{className:"px-3 py-4 text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:()=>M(a),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Edit",children:e.jsx(W,{size:14})}),e.jsx("button",{type:"button",onClick:()=>I(a),className:"text-red-600 hover:text-red-900 p-1 rounded",title:"Hapus",children:e.jsx(Y,{size:14})})]})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-3 py-12 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("p",{children:"Belum ada kalender akademik yang ditambahkan."}),e.jsx(b,{onClick:w,className:"mt-2",children:"Tambah Kalender Pertama"})]})})})})]})}),s.links&&s.links.length>3&&e.jsx("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Menampilkan ",s.from," - ",s.to," dari ",s.total," hasil"]}),e.jsx("div",{className:"flex gap-1",children:s.links.map((a,r)=>e.jsx("button",{onClick:()=>a.url&&m.get(a.url),disabled:!a.url,className:`px-3 py-1 text-sm rounded ${a.active?"bg-primary text-white":a.url?"bg-white text-gray-700 border hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:a.label}},r))})]})})]}),e.jsx(B,{show:C,onClose:p,maxWidth:"2xl",children:e.jsxs("form",{onSubmit:G,className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:h?"Edit Kalender Akademik":"Tambah Kalender Akademik"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"1"}),"Informasi Kalender"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Detail kalender akademik"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"title",value:"Judul"}),e.jsx(g,{id:"title",type:"text",className:"mt-1 block w-full",value:t.title,onChange:a=>l("title",a.target.value),required:!0,placeholder:"Contoh: Kalender Akademik SMA Negeri 1 Baleendah"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Judul untuk kalender akademik"}),e.jsx(j,{message:o.title,className:"mt-2"})]})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"2"}),"Gambar Kalender"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Upload gambar kalender akademik"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"calendar_image",value:"Gambar Kalender"}),e.jsx(q,{id:"calendar_image",label:"Gambar Kalender",previewUrl:A,onChange:a=>{if(u(a),l("calendar_image",a),a){const r=new FileReader;r.onload=i=>{c(i.target.result)},r.readAsDataURL(a)}else c("")},error:o.calendar_image,description:"Pilih file gambar kalender akademik (JPG, PNG, GIF, SVG - Maksimal 2MB)"})]})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"3"}),"Periode Akademik"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Tahun dan semester akademik"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"academic_year_start",value:"Tahun Awal Akademik"}),e.jsx(g,{id:"academic_year_start",type:"number",className:"mt-1 block w-full",value:t.academic_year_start,onChange:a=>l("academic_year_start",parseInt(a.target.value)||new Date().getFullYear()),required:!0,placeholder:"2024",min:"2000",max:"2100"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Contoh: 2024 untuk tahun akademik 2024/2025"}),e.jsx(j,{message:o.academic_year_start,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"semester",value:"Semester"}),e.jsxs("select",{id:"semester",className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",value:t.semester,onChange:a=>l("semester",parseInt(a.target.value)),required:!0,children:[e.jsx("option",{value:1,children:"Semester Ganjil"}),e.jsx("option",{value:2,children:"Semester Genap"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Pilih semester akademik"}),e.jsx(j,{message:o.semester,className:"mt-2"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx(x,{htmlFor:"sort_order",value:"Urutan"}),e.jsx(g,{id:"sort_order",type:"number",className:"mt-1 block w-24",value:t.sort_order,onChange:a=>l("sort_order",parseInt(a.target.value)||0),min:"0"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Urutan tampilan"}),e.jsx(j,{message:o.sort_order,className:"mt-2"})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(J,{type:"button",onClick:p,children:"Batal"}),e.jsx(b,{type:"submit",disabled:N,className:"!bg-accent-yellow !text-gray-900 hover:!bg-yellow-500 shadow-sm",children:N?"Menyimpan...":h?"Perbarui":"Simpan"})]})]})})]})}export{pe as default};
