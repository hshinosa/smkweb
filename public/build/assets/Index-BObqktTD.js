import{j as e}from"./markdown-vendor-CIGiOj7E.js";import{q as ge,r as o,S as pe,R as H,f as l}from"./inertia-vendor-CFsdYvsV.js";import{P as he}from"./PrimaryButton-BP4GzKQS.js";import{T}from"./TextInput-DXlIWAoE.js";import{I as F}from"./InputLabel-B7Cy73bq.js";import{I as ue}from"./InputError-CW7Z9Fko.js";import{C as be}from"./ContentManagementPage-CS4dHDNy.js";import{z as t}from"./app-SCjtbprB.js";import{K as J,F as O,p as u,z as je,H as M,J as b,I as U,O as j,T as ye,Q as fe,t as Ne,a as ve,W as we,r as B,Y as q,c as ke}from"./ui-vendor-DKvpuSCb.js";import"./react-vendor-X_fu8xpB.js";import"./typography-ChUjANkt.js";import"./AdminLayout-BYuG-4eb.js";import"./transition-CiB-21bZ.js";function Ke({apifyToken:n,statistics:d,logs:w,pendingPosts:m={data:[]},activeTab:W}){const{success:k,error:S}=ge().props,[g,p]=o.useState(W||"api-key"),[P,I]=o.useState(!1),[i,y]=o.useState([]),[L,Q]=o.useState("berita"),[A,f]=o.useState({show:!1,post:null}),[c,_]=o.useState({title:"",category:"berita"}),[C,E]=o.useState(null),[x,$]=o.useState(""),[N,R]=o.useState(!1),r=m?.data||[],G=m?.meta?.total||0,{data:K,setData:Y,post:Z,processing:D,errors:V}=pe({apify_token:n||""}),X=[{key:"api-key",label:"Apify API Key",description:"Manage Apify API token for Instagram scraping",icon:J},{key:"pending",label:`Pending Posts (${G})`,description:"Approve scraped posts as news drafts",icon:O},{key:"statistics",label:"Statistics",description:"Scraping statistics and activity",icon:u},{key:"logs",label:"Scraper Logs",description:"Scraper run history and logs",icon:u}],ee=s=>{s.preventDefault(),Z(route("admin.instagram-settings.update"),{preserveScroll:!1,onSuccess:()=>{t.success("API key berhasil disimpan")},onError:a=>{console.error("Save errors:",a),t.error("Gagal menyimpan API key")}})},se=()=>{if(!n){t.error("Silakan atur API token terlebih dahulu"),p("api-key");return}I(!0),t.success("Scraper dimulai di background. Pantau status di Scraper Logs.",{duration:4e3}),l.post(route("admin.instagram-scraper.run"),{username:"sman1baleendah",max_posts:25},{onSuccess:()=>{I(!1),p("logs")},onError:s=>{t.error("Gagal memulai scraper."),I(!1)}})},ae=()=>{if(!n){t.error("Silakan atur API token terlebih dahulu"),p("api-key");return}if(!x.trim()){t.error("Masukkan URL Instagram post");return}if(!x.match(/instagram\.com\/(p|reel|tv)\/[A-Za-z0-9_-]+/)){t.error("URL tidak valid. Gunakan format: https://www.instagram.com/p/SHORTCODE");return}R(!0),t.loading("Scraping post dari Instagram...",{duration:3e3}),l.post(route("admin.instagram-scraper.single-post"),{post_url:x},{onSuccess:()=>{R(!1),$(""),p("pending")},onError:s=>{t.error("Gagal scrape post."),R(!1)}})},te=s=>{const h=(s.caption||"").split(`
`)[0]?.substring(0,200)||`Instagram Post ${s.shortcode}`;_({title:h,category:"berita",image_paths:s.image_paths||[]}),f({show:!0,post:s})},re=()=>{if(!c.title.trim()){t.error("Judul harus diisi");return}l.post(route("admin.instagram-posts.approve",A.post.id),{title:c.title,category:c.category},{onSuccess:()=>{t.success("Post sedang diproses di background. Cek halaman berita untuk melihat hasilnya."),f({show:!1,post:null})},onError:s=>{t.error("Gagal approve post")}})},le=s=>{confirm("Apakah Anda yakin ingin menghapus post ini? Tindakan ini tidak dapat dibatalkan.")&&l.delete(route("admin.instagram-posts.reject",s),{onSuccess:()=>{t.success("Post berhasil dihapus")},onError:()=>{t.error("Gagal menghapus post")}})},z=s=>{E(s),t.loading("Memproses dengan AI... Mohon tunggu.",{duration:3e3}),l.post(route("admin.instagram-posts.process-ai",s),{},{onSuccess:()=>{t.success("Post sedang diproses dengan AI di background. Cek halaman berita dalam beberapa menit."),E(null)},onError:()=>{t.error("Gagal memproses dengan AI. Coba lagi atau periksa konfigurasi AI."),E(null)}})},ne=s=>{l.post(route("admin.instagram-posts.reset-status",s),{},{onSuccess:()=>{t.success("Status berhasil direset. Post siap diproses ulang.")},onError:()=>{t.error("Gagal reset status.")}})},ie=()=>{confirm("Reset semua post yang stuck? Post yang sedang diproses lebih dari 10 menit akan di-reset.")&&l.post(route("admin.instagram-posts.cleanup-stuck"),{},{onSuccess:()=>{t.success("Semua post stuck berhasil di-reset.")},onError:()=>{t.error("Gagal cleanup stuck posts.")}})},ce=s=>{y(a=>a.includes(s)?a.filter(h=>h!==s):[...a,s])},oe=()=>{i.length===r.length?y([]):y(r.map(s=>s.id))},de=()=>{if(i.length===0){t.error("Pilih minimal 1 post");return}l.post(route("admin.instagram-posts.bulk-approve"),{ids:i,category:L},{onSuccess:()=>{t.success(`${i.length} post sedang diproses di background. Halaman akan dimuat ulang untuk melihat status terbaru.`),y([]),setTimeout(()=>window.location.reload(),1500)},onError:()=>{t.error("Gagal bulk approve")}})};return H.useEffect(()=>{if(r.some(a=>a.processing_status)){let a=0;const h=20,v=setInterval(()=>{if(a++,a>h){clearInterval(v),console.warn("Polling timeout: Background process taking too long or stuck.");return}l.reload({only:["pendingPosts","statistics"],preserveScroll:!0,onSuccess:me=>{(me.props.pendingPosts?.data||[]).some(xe=>xe.processing_status)||(clearInterval(v),t.success("Semua proses background selesai!",{id:"bg-sync-done"}))},onError:()=>{clearInterval(v)}})},3e3);return()=>clearInterval(v)}},[r]),H.useEffect(()=>{k&&t.success(k),S&&t.error(S)},[k,S]),e.jsxs(be,{headerTitle:"Instagram Settings",headTitle:"Instagram Settings",tabs:X,activeTab:g,setActiveTab:p,noForm:!0,children:[g==="api-key"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(J,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Apify API Configuration"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Configure Apify API token untuk scraping Instagram posts. Dapatkan token dari ",e.jsx("a",{href:"https://console.apify.com/account/integrations",target:"_blank",rel:"noreferrer",className:"text-purple-600 hover:underline",children:"Apify Console"}),"."]})]})]}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"apify_token",value:"Apify API Token"}),e.jsx(T,{id:"apify_token",type:"password",className:"mt-1 block w-full",value:K.apify_token,onChange:s=>Y("apify_token",s.target.value),placeholder:"apify_api_xxxxxxxxxxxxxxxxxx"}),e.jsx(ue,{message:V.apify_token,className:"mt-2"}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Token akan disimpan di database"})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[e.jsxs(he,{type:"submit",disabled:D,children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),D?"Menyimpan...":"Simpan API Key"]}),K.apify_token&&e.jsxs("span",{className:"text-sm text-green-600 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-green-600 rounded-full"}),"API Key tersimpan"]})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Cara Mendapatkan API Token:"}),e.jsxs("ol",{className:"text-sm text-gray-600 space-y-2 list-decimal list-inside",children:[e.jsxs("li",{children:["Buka ",e.jsx("a",{href:"https://console.apify.com/account/integrations",target:"_blank",rel:"noreferrer",className:"text-purple-600 hover:underline",children:"Apify Console"})]}),e.jsx("li",{children:"Login atau buat akun baru (gratis untuk 100 credits/bulan)"}),e.jsx("li",{children:'Ke menu "Settings" â†’ "Integrations"'}),e.jsx("li",{children:'Copy "Personal API Token"'}),e.jsx("li",{children:"Paste token di form di atas dan simpan"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"ðŸ’¡ Info Penggunaan"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Free tier: 100 Apify credits/bulan (~500 posts)"}),e.jsx("li",{children:"â€¢ Scraping 1 post â‰ˆ 0.2 credits"}),e.jsx("li",{children:"â€¢ Scraping 25 posts â‰ˆ 5 credits"}),e.jsxs("li",{children:["â€¢ Token ini digunakan oleh command: ",e.jsx("code",{className:"bg-blue-100 px-2 py-0.5 rounded",children:"php artisan instagram:scrape --apify"})]})]})]})]})}),g==="pending"&&e.jsxs("div",{className:"space-y-6",children:[r.length>0&&e.jsx("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:i.length===r.length&&r.length>0,onChange:oe,className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsxs("span",{className:"text-gray-700",children:["Pilih Semua (",i.length,"/",r.length,")"]})]}),i.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:L,onChange:s=>Q(s.target.value),className:"text-sm border-gray-300 rounded-lg focus:ring-accent-yellow focus:border-accent-yellow",children:[e.jsx("option",{value:"berita",children:"Berita"}),e.jsx("option",{value:"pengumuman",children:"Pengumuman"}),e.jsx("option",{value:"prestasi",children:"Prestasi"}),e.jsx("option",{value:"akademik",children:"Akademik"}),e.jsx("option",{value:"kegiatan",children:"Kegiatan"})]}),e.jsxs("button",{onClick:de,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:[e.jsx(M,{className:"w-4 h-4"}),"Approve ",i.length," Post"]})]}),r.some(s=>s.processing_status)&&e.jsxs("button",{onClick:ie,className:"ml-auto inline-flex items-center gap-2 px-3 py-2 bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 transition-colors text-sm font-medium",title:"Reset semua post yang stuck",children:[e.jsx(b,{className:"w-4 h-4"}),"Reset Stuck Posts"]})]})}),r.length===0?e.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 p-12 text-center",children:[e.jsx(O,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Tidak ada post yang menunggu approval"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Jalankan scraper untuk mengambil post baru dari Instagram"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(s=>e.jsxs("div",{className:"bg-white shadow-md rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow duration-200",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("input",{type:"checkbox",checked:i.includes(s.id),onChange:()=>ce(s.id),className:"w-5 h-5 rounded border-2 border-gray-400 text-accent-yellow focus:ring-accent-yellow focus:ring-offset-2 bg-white shadow-lg cursor-pointer"})}),s.first_image?e.jsx("img",{src:s.first_image,alt:"Instagram post",className:"w-full h-56 object-cover bg-gray-100 group-hover:scale-105 transition-transform duration-200",onError:a=>{a.target.style.display="none",a.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:`w-full h-56 bg-gray-100 items-center justify-center ${s.first_image?"hidden":"flex"}`,children:e.jsx(U,{className:"w-16 h-16 text-gray-300"})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-3",children:[e.jsx(j,{className:"w-4 h-4 text-pink-500"}),e.jsxs("span",{className:"font-medium",children:["@",s.username]}),e.jsx("span",{className:"text-gray-300",children:"â€¢"}),e.jsx("span",{className:"text-xs",children:s.scraped_ago})]}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-3 mb-4 leading-relaxed",children:s.caption_preview||"No caption"}),s.error_message&&!s.processing_status&&e.jsxs("div",{className:"mb-4 p-2 bg-red-50 rounded border-l-2 border-red-400",children:[e.jsxs("p",{className:"text-[10px] text-red-700 font-medium",children:["âš ï¸ Gagal: ",s.error_message]}),e.jsx("button",{onClick:()=>z(s.id),className:"mt-1 text-[10px] font-bold text-red-800 underline hover:no-underline",children:"Coba lagi dengan AI"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mb-4 pb-4 border-b border-gray-100",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-bold text-red-500",children:"â¤ï¸"})," ",s.likes_count]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-bold",children:"ðŸ’¬"})," ",s.comments_count]})]}),e.jsx("div",{className:"space-y-2",children:s.processing_status?e.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-400",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-blue-700 uppercase tracking-wider",children:"Processing"}),e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:[e.jsx(b,{className:"w-3 h-3 animate-spin"}),s.processing_status==="queued_ai"?"AI Working...":s.processing_status==="processing"?"Processing...":"In Queue"]})]}),e.jsxs("p",{className:"text-[10px] text-blue-600 italic font-mono truncate",children:["ID: ",s.shortcode]}),e.jsx("button",{onClick:()=>ne(s.id),className:"mt-1 text-xs font-medium text-orange-700 bg-orange-100 px-2 py-1 rounded hover:bg-orange-200 transition-colors",children:"â†» Reset jika stuck"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>te(s),className:"flex-1 inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 active:bg-green-800 transition-colors text-sm font-semibold shadow-sm hover:shadow-md",children:[e.jsx(M,{className:"w-4 h-4"}),"Approve"]}),e.jsx("button",{onClick:()=>le(s.id),className:"inline-flex items-center justify-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 active:bg-red-800 transition-colors text-sm font-semibold shadow-sm hover:shadow-md",title:"Hapus",children:e.jsx(ye,{className:"w-4 h-4"})})]}),e.jsx("button",{onClick:()=>z(s.id),disabled:C===s.id,className:`w-full inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg transition-all text-sm font-semibold shadow-sm ${C===s.id?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-accent-yellow text-gray-900 hover:bg-yellow-500 hover:shadow-md active:bg-yellow-600"}`,children:C===s.id?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-5 h-5"}),"Process with AI"]})})]})})]})]},s.id))}),m?.links&&m.links.length>3&&e.jsx("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 px-4 sm:px-6 py-3 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:m.meta?.from||1})," to ",e.jsx("span",{className:"font-medium",children:m.meta?.to||r.length})," of ",e.jsx("span",{className:"font-medium",children:G})," results"]})}),e.jsx("div",{className:"flex gap-2",children:e.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:m.links.map((s,a)=>s.label==="&laquo; Previous"?e.jsxs("button",{onClick:()=>s.url&&l.get(s.url,{},{preserveState:!0,preserveScroll:!0}),disabled:!s.url,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"sr-only",children:"Previous"}),e.jsx(Ne,{className:"h-5 w-5","aria-hidden":"true"})]},a):s.label==="Next &raquo;"?e.jsxs("button",{onClick:()=>s.url&&l.get(s.url,{},{preserveState:!0,preserveScroll:!0}),disabled:!s.url,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"sr-only",children:"Next"}),e.jsx(ve,{className:"h-5 w-5","aria-hidden":"true"})]},a):e.jsx("button",{onClick:()=>s.url&&l.get(s.url,{},{preserveState:!0,preserveScroll:!0}),disabled:s.active,className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${s.active?"z-10 bg-accent-yellow border-accent-yellow text-gray-900":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,dangerouslySetInnerHTML:{__html:s.label}},a))})})]})})]}),A.show&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:()=>f({show:!1,post:null})}),e.jsxs("div",{className:"relative inline-block w-full max-w-lg p-6 my-8 text-left bg-white rounded-xl shadow-xl transform transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(M,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Approve sebagai Draft Berita"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"title",value:"Judul Berita"}),e.jsx(T,{id:"title",type:"text",className:"mt-1 block w-full text-sm py-3 px-4",value:c.title,onChange:s=>_(a=>({...a,title:s.target.value})),placeholder:"Masukkan judul berita"})]}),e.jsxs("div",{children:[e.jsx(F,{htmlFor:"category",value:"Kategori"}),e.jsxs("select",{id:"category",value:c.category,onChange:s=>_(a=>({...a,category:s.target.value})),className:"mt-1 block w-full border-gray-300 rounded-lg focus:ring-accent-yellow focus:border-accent-yellow",children:[e.jsx("option",{value:"berita",children:"Berita"}),e.jsx("option",{value:"pengumuman",children:"Pengumuman"}),e.jsx("option",{value:"prestasi",children:"Prestasi"}),e.jsx("option",{value:"akademik",children:"Akademik"}),e.jsx("option",{value:"kegiatan",children:"Kegiatan"})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Images (",c.image_paths?.length||0,"):"]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-gray-300",children:[c.image_paths?.map((s,a)=>e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("img",{src:s,alt:`Post thumbnail ${a+1}`,className:"w-20 h-20 object-cover rounded-md border border-gray-200"}),e.jsx("div",{className:"absolute top-0 right-0 bg-black/50 text-white text-[8px] px-1 rounded-bl-md",children:a+1})]},a)),(!c.image_paths||c.image_paths.length===0)&&e.jsx("div",{className:"w-20 h-20 flex items-center justify-center bg-gray-100 rounded-md border border-dashed border-gray-300",children:e.jsx(U,{className:"w-6 h-6 text-gray-400"})})]})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Preview Caption:"}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-4",children:A.post?.caption_preview})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>f({show:!1,post:null}),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Batal"}),e.jsx("button",{type:"button",onClick:re,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 transition-colors",children:"Approve sebagai Draft"})]})]})]})}),g==="statistics"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Scraped"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.total_scraped})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Processing"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:d.pending_processing})]}),e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(u,{className:"w-6 h-6 text-yellow-600"})})]})}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Processed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:d.processed})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(j,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Errors"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:d.errors})]}),e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(u,{className:"w-6 h-6 text-red-600"})})]})})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Sources"})}),e.jsx("div",{className:"p-6",children:d.by_source.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No scraping activity yet"}):e.jsx("div",{className:"space-y-3",children:d.by_source.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"w-5 h-5 text-pink-500"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["@",s.username]})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.count," posts"]})]},a))})})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"})}),e.jsx("div",{className:"p-6",children:d.recent_activity.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No recent activity"}):e.jsx("div",{className:"space-y-3",children:d.recent_activity.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{className:"w-5 h-5 text-blue-500"}),e.jsxs("span",{className:"text-gray-900",children:["@",s.username]}),e.jsx("span",{className:"text-sm text-gray-500",children:s.time})]}),e.jsx("span",{className:`text-xs px-2.5 py-1 rounded-full ${s.status==="Processed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})]},a))})})]})]}),g==="logs"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-pink-100 rounded-lg",children:e.jsx(we,{className:"w-6 h-6 text-pink-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Scrape Post Tunggal"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Masukkan link Instagram post untuk scrape satu postingan saja. Support: instagram.com/p/xxx, instagram.com/reel/xxx"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(T,{type:"url",value:x,onChange:s=>$(s.target.value),placeholder:"https://www.instagram.com/p/SHORTCODE",className:"flex-1",disabled:N}),e.jsx("button",{onClick:ae,disabled:N||!n||!x.trim(),className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${N||!n||!x.trim()?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-pink-600 text-white hover:bg-pink-700"}`,children:N?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 animate-spin"}),"Scraping..."]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4"}),"Scrape Post"]})})]}),!n&&e.jsxs("p",{className:"text-xs text-red-600 mt-2 flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"Silakan atur API token terlebih dahulu"]})]})]})}),e.jsx("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(q,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Jalankan Instagram Scraper"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Klik tombol di bawah untuk menjalankan scraper Instagram secara manual. Scraper akan mengambil 25 post terbaru dari @sman1baleendah."}),e.jsxs("button",{onClick:se,disabled:P||!n,className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${P||!n?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-orange-600 text-white hover:bg-orange-700"}`,children:[e.jsx(q,{className:"w-4 h-4"}),P?"Scraping...":"Jalankan Scraper Sekarang"]}),!n&&e.jsxs("p",{className:"text-xs text-red-600 mt-2 flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"Silakan atur API token terlebih dahulu"]})]})]})}),e.jsxs("div",{className:"bg-white shadow-sm rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Scraper Logs"})}),e.jsx("div",{className:"p-6",children:!w||w.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Belum ada log scraper"}):e.jsx("div",{className:"space-y-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-900",children:"Username"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-900",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-900",children:"Posts"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-900",children:"Waktu"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-900",children:"Durasi"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-900",children:"Message"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:w.map((s,a)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3 text-gray-900 font-medium",children:["@",s.username]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="running"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:[s.status==="completed"&&e.jsx(ke,{className:"w-3 h-3"}),s.status==="running"&&e.jsx(b,{className:"w-3 h-3 animate-spin"}),s.status==="failed"&&e.jsx(B,{className:"w-3 h-3"}),s.status]})}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:s.posts_found?`${s.posts_found} posts`:"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-600 whitespace-nowrap",children:s.started_at}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:s.duration}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:s.message?e.jsxs("span",{title:s.message,children:[s.message.substring(0,30),"..."]}):s.error_message?e.jsxs("span",{title:s.error_message,className:"text-red-600",children:[s.error_message.substring(0,30),"..."]}):"-"})]},a))})]})})})]})]})]})}export{Ke as default};
