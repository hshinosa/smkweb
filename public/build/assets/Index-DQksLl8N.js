import{j as e}from"./markdown-vendor-CIGiOj7E.js";import{q as J,r as i,S as X}from"./inertia-vendor-CFsdYvsV.js";import{T as v}from"./TextInput-DXlIWAoE.js";import{I as c}from"./InputLabel-B7Cy73bq.js";import{I as u}from"./InputError-CW7Z9Fko.js";import{P as N}from"./PrimaryButton-BP4GzKQS.js";import{F as Q}from"./FileUploadField-DGzk2RBu.js";import{C as Z}from"./ContentManagementPage-DVU9nbB8.js";import{M as ee}from"./Modal-rJC0U0UH.js";import{z as g}from"./app-BjrorLXI.js";import{U as _,e as te,V as O,i as se,P as ae,T as re,X as w,F as le,I as ie,G as V}from"./ui-vendor-DKvpuSCb.js";import"./react-vendor-X_fu8xpB.js";import"./typography-ChUjANkt.js";import"./AdminLayout-BGv0ni_W.js";import"./transition-CiB-21bZ.js";import"./index-CjLAxSrQ.js";function we({alumnis:k}){const{success:ne}=J().props,[G,C]=i.useState(!1),[h,T]=i.useState(!1),[Y,D]=i.useState(null),[B,L]=i.useState("list"),{data:a,setData:r,post:A,delete:$,processing:I,errors:d,reset:F,transform:S}=X({name:"",graduation_year:new Date().getFullYear(),testimonial:"",content_type:"text",image_url:"",testimonial_images:[],existing_testimonial_images:[],video_source:"youtube",video_url:"",video_file:null,is_featured:!1,is_published:!0,sort_order:0}),R=[{key:"list",label:"Daftar Alumni",description:"Kelola data alumni.",icon:_}],b=(t=null)=>{t?(T(!0),D(t.id),r({name:t.name||"",graduation_year:t.graduation_year||new Date().getFullYear(),testimonial:t.testimonial||"",content_type:t.content_type||"text",image_url:t.image_url||"",testimonial_images:[],existing_testimonial_images:Array.isArray(t.testimonialImages)?t.testimonialImages.map(s=>s.original_url).filter(Boolean):[],video_source:t.video_source||"youtube",video_url:t.video_url||"",video_file:null,is_featured:!!t.is_featured,is_published:!!t.is_published,sort_order:t.sort_order||0})):(T(!1),D(null),F(),r(s=>({...s,testimonial_images:[],existing_testimonial_images:[]}))),C(!0)},x=()=>{C(!1),F(),r(t=>({...t,testimonial_images:[],existing_testimonial_images:[]}))},K=t=>{t.preventDefault(),h?(S(s=>({...s,_method:"PUT"})),A(route("admin.alumni.update",Y),{forceFormData:!0,onSuccess:()=>{x(),g.success("Data alumni berhasil diperbarui")},onError:s=>{const l=Object.values(s||{})[0];g.error(l||"Gagal memperbarui data alumni")}})):(S(s=>s),A(route("admin.alumni.store"),{forceFormData:!0,onSuccess:()=>{x(),g.success("Alumni baru berhasil ditambahkan")},onError:s=>{const l=Object.values(s||{})[0];g.error(l||"Gagal menambahkan alumni")}}))},q=t=>{!Array.isArray(t)||t.length===0||r(s=>({...s,testimonial_images:[...s.testimonial_images||[],...t]}))},y=i.useMemo(()=>(a.testimonial_images||[]).map(t=>({name:t.name,url:URL.createObjectURL(t)})),[a.testimonial_images]);i.useEffect(()=>()=>{y.forEach(t=>{URL.revokeObjectURL(t.url)})},[y]);const[n,f]=i.useState(null),[z,j]=i.useState(null),E=i.useCallback((t,s)=>{f({index:t,type:s})},[]),U=i.useCallback((t,s)=>{t.preventDefault(),j(s)},[]),M=i.useCallback((t,s)=>{if(!n)return;const l=n.type==="existing"?"existing_testimonial_images":"testimonial_images",o=s==="existing"?"existing_testimonial_images":"testimonial_images";if(l===o){const m=[...a[l]||[]],[p]=m.splice(n.index,1);m.splice(t,0,p),r(l,m)}else{const m=[...a[l]||[]],p=[...a[o]||[]],[H]=m.splice(n.index,1);p.splice(t,0,H),r(l,m),r(o,p)}f(null),j(null)},[n,a,r]),P=i.useCallback(()=>{f(null),j(null)},[]),W=t=>{confirm("Apakah Anda yakin ingin menghapus data alumni ini? Tindakan ini tidak dapat dibatalkan.")&&$(route("admin.alumni.destroy",t),{preserveScroll:!0,onSuccess:()=>g.success("Data alumni berhasil dihapus")})};return e.jsxs(Z,{headerTitle:"Kelola Alumni",headTitle:"Jejak Alumni",tabs:R,activeTab:B,setActiveTab:L,noForm:!0,children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-gray-200 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Daftar Alumni"}),e.jsxs(N,{type:"button",onClick:()=>b(),className:"!bg-accent-yellow !text-gray-900 hover:!bg-yellow-500 flex items-center gap-2 px-4 py-2 text-sm font-medium w-full sm:w-auto justify-center",children:[e.jsx(te,{size:18}),"Tambah Alumni"]})]}),k.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Alumni"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Angkatan"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-500 uppercase",children:"Featured"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:k.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:(()=>{const s=Array.isArray(t.testimonialImages)&&t.testimonialImages.length>0?t.testimonialImages[0]?.original_url:t.image_url;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-100 flex-shrink-0 border-2 border-gray-200",children:s?e.jsx("img",{src:s,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(_,{size:18})})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm",children:t.name}),t.content_type==="video"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:[e.jsx(O,{size:10})," ",t.video_source==="youtube"?"YouTube":"Upload"]})]})})]})})()}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-lg text-sm font-medium bg-accent-yellow/10 text-accent-yellow",children:t.graduation_year})}),e.jsx("td",{className:"px-4 py-3 text-center",children:t.is_featured?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-700",children:[e.jsx(se,{size:12,fill:"currentColor"})," Ya"]}):e.jsx("span",{className:"text-gray-300",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:()=>b(t),className:"p-2 !text-accent-yellow hover:bg-accent-yellow/10 rounded-lg",children:e.jsx(ae,{size:16})}),e.jsx("button",{onClick:()=>W(t.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(re,{size:16})})]})})]},t.id))})]})}):e.jsxs("div",{className:"p-8 sm:p-12 text-center",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(_,{size:24,className:"sm:w-8 sm:h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 font-medium mb-4 text-sm sm:text-base",children:"Belum ada alumni"}),e.jsx(N,{onClick:()=>b(),className:"!bg-accent-yellow !text-gray-900 hover:!bg-yellow-500 text-sm sm:text-base px-4 py-2",children:"Tambah Alumni"})]})]}),e.jsx(ee,{show:G,onClose:x,maxWidth:"2xl",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full mx-auto max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900",children:h?"Edit Alumni":"Tambah Alumni"}),e.jsx("button",{onClick:x,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:e.jsx(w,{size:20})})]}),e.jsxs("form",{onSubmit:K,className:"p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"1"}),"Tipe Konten"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Pilih format testimoni alumni"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"content_type",value:"text",checked:a.content_type==="text",onChange:t=>r(s=>({...s,content_type:"text",is_featured:!1})),className:"w-4 h-4 text-accent-yellow focus:ring-accent-yellow"}),e.jsx(le,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Testimoni (Teks)"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"content_type",value:"video",checked:a.content_type==="video",onChange:t=>r(s=>({...s,content_type:"video",is_featured:!0})),className:"w-4 h-4 text-accent-yellow focus:ring-accent-yellow"}),e.jsx(O,{size:16,className:"text-red-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Video (Featured)"})]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Video otomatis ditampilkan sebagai featured"})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"2"}),"Data Alumni"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Informasi identitas alumni"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"name",value:"Nama"}),e.jsx(v,{id:"name",type:"text",className:"mt-1 block w-full",value:a.name,onChange:t=>r("name",t.target.value),required:!0,placeholder:"Nama..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Nama lengkap alumni"}),e.jsx(u,{message:d.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"graduation_year",value:"Tahun Lulus"}),e.jsx(v,{id:"graduation_year",type:"number",className:"mt-1 block w-full",value:a.graduation_year,onChange:t=>r("graduation_year",t.target.value)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Angkatan kelulusan"})]})]})]}),a.content_type==="text"?e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"3"}),"Testimoni"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Cerita dan pengalaman alumni"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"testimonial",value:"Testimoni"}),e.jsx("textarea",{id:"testimonial",className:"mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:border-accent-yellow text-sm",rows:"3",value:a.testimonial,onChange:t=>r("testimonial",t.target.value),required:!0,placeholder:"Cerita alumni..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Cerita singkat dari alumni"}),e.jsx(u,{message:d.testimonial,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"testimonial_images",value:"Galeri Foto Testimoni"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload beberapa foto untuk ditampilkan sebagai carousel di modal testimoni (maksimal 10 foto)."}),e.jsxs("label",{htmlFor:"testimonial_images",className:"mt-3 flex h-32 w-full cursor-pointer flex-col items-center justify-center rounded-xl border-2 border-dashed border-gray-300 bg-gray-50 transition hover:border-accent-yellow hover:bg-yellow-50/40",children:[e.jsx(ie,{size:28,className:"text-gray-400 mb-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Klik atau drag untuk upload foto"}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:"JPEG, PNG, WebP Â· maks 10MB/foto"}),e.jsx("input",{id:"testimonial_images",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:t=>{t.target.files&&t.target.files.length>0&&(q(Array.from(t.target.files)),t.target.value="")}})]}),(a.existing_testimonial_images?.length>0||a.testimonial_images?.length>0)&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-500 italic",children:"* Geser gambar untuk mengubah urutan tampil di carousel"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[(a.existing_testimonial_images||[]).map((t,s)=>e.jsxs("div",{draggable:!0,onDragStart:l=>E(s,"existing"),onDragOver:l=>U(l,s),onDrop:()=>M(s,"existing"),onDragEnd:P,className:`relative overflow-hidden rounded-lg border-2 transition-all cursor-move ${z===s&&n?.type==="existing"?"border-primary border-dashed scale-105":"border-gray-200"} ${n?.index===s&&n?.type==="existing"?"opacity-50":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 z-10 p-1",children:e.jsx(V,{size:14,className:"text-gray-400"})}),e.jsx("img",{src:t,alt:`Existing testimonial ${s+1}`,className:"h-24 w-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>{r("existing_testimonial_images",(a.existing_testimonial_images||[]).filter((l,o)=>o!==s))},className:"absolute right-1 top-1 rounded-full bg-white/90 p-1 text-red-600 shadow","aria-label":"Hapus gambar yang sudah ada",children:e.jsx(w,{size:12})}),e.jsx("span",{className:"absolute bottom-1 left-1 rounded bg-black/60 px-1.5 py-0.5 text-[10px] text-white",children:s+1})]},`existing-${s}`)),y.map((t,s)=>e.jsxs("div",{draggable:!0,onDragStart:l=>E(s,"new"),onDragOver:l=>U(l,s),onDrop:()=>M(s,"new"),onDragEnd:P,className:`relative overflow-hidden rounded-lg border-2 border-primary/20 transition-all cursor-move ${z===s&&n?.type==="new"?"border-primary border-dashed scale-105":""} ${n?.index===s&&n?.type==="new"?"opacity-50":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 z-10 p-1",children:e.jsx(V,{size:14,className:"text-primary"})}),e.jsx("img",{src:t.url,alt:t.name,className:"h-24 w-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>{r("testimonial_images",(a.testimonial_images||[]).filter((l,o)=>o!==s))},className:"absolute right-1 top-1 rounded-full bg-white/90 p-1 text-red-600 shadow","aria-label":"Hapus gambar baru",children:e.jsx(w,{size:12})}),e.jsxs("span",{className:"absolute bottom-1 left-1 rounded bg-primary/80 px-1.5 py-0.5 text-[10px] text-white",children:["Baru ",s+1]})]},`new-${s}`))]})]}),e.jsx(u,{message:d.testimonial_images,className:"mt-2"}),e.jsx(u,{message:d["testimonial_images.0"],className:"mt-2"})]})]}):e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"3"}),"Video Testimoni"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Upload video atau masukkan link YouTube"})]}),e.jsxs("div",{children:[e.jsx(c,{value:"Sumber Video"}),e.jsxs("div",{className:"mt-2 flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-gray-50 px-3 py-2 rounded-lg border border-gray-200 hover:bg-gray-100",children:[e.jsx("input",{type:"radio",name:"video_source",value:"youtube",checked:a.video_source==="youtube",onChange:t=>r("video_source",t.target.value),className:"w-4 h-4 text-accent-yellow focus:ring-accent-yellow"}),e.jsx("span",{className:"text-sm text-gray-700",children:"YouTube"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-gray-50 px-3 py-2 rounded-lg border border-gray-200 hover:bg-gray-100",children:[e.jsx("input",{type:"radio",name:"video_source",value:"upload",checked:a.video_source==="upload",onChange:t=>r("video_source",t.target.value),className:"w-4 h-4 text-accent-yellow focus:ring-accent-yellow"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Upload File"})]})]})]}),a.video_source==="youtube"?e.jsxs("div",{children:[e.jsx(c,{htmlFor:"video_url",value:"URL Video YouTube"}),e.jsx(v,{id:"video_url",type:"url",className:"mt-1 block w-full",value:a.video_url,onChange:t=>r("video_url",t.target.value),placeholder:"https://youtube.com/watch?v=..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Salin link video dari YouTube"}),e.jsx(u,{message:d.video_url,className:"mt-2"})]}):e.jsxs("div",{children:[e.jsx(c,{htmlFor:"video_file",value:"File Video"}),e.jsx(Q,{id:"video_file",label:"Upload Video",accept:"video/*",fileType:"video",onChange:t=>r("video_file",t),previewUrl:getImageUrl(a.video_url),error:d.video_file,description:"Format: MP4, WebM. Maksimal 50MB."})]})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm",children:"4"}),"Pengaturan"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Status publikasi"})]}),e.jsx("div",{className:"flex flex-wrap gap-4 sm:gap-6",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"is_published",checked:a.is_published,onChange:t=>r("is_published",t.target.checked),className:"w-4 h-4 rounded border-gray-300 text-accent-yellow focus:ring-accent-yellow"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Publish"})]})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Centang untuk menampilkan di website"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 text-gray-700 hover:text-gray-900 font-medium",children:"Batal"}),e.jsx(N,{type:"submit",disabled:I,className:"!bg-accent-yellow !text-gray-900 hover:!bg-yellow-500 px-5 py-2",children:I?"...":h?"Simpan":"Tambah"})]})]})]})})]})}export{we as default};
