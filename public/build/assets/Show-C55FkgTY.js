import{j as e}from"./markdown-vendor-CIGiOj7E.js";import{r as l,S as C,J as Q,f as W}from"./inertia-vendor-CFsdYvsV.js";import{C as H}from"./ContentManagementPage-CS4dHDNy.js";import{M as T}from"./Modal-rJC0U0UH.js";import{T as k}from"./TextInput-DXlIWAoE.js";import{I as x}from"./InputLabel-B7Cy73bq.js";import{I as u}from"./InputError-CW7Z9Fko.js";import{P as d}from"./PrimaryButton-BP4GzKQS.js";import{z as c}from"./app-SCjtbprB.js";import{ap as P,A as R,o as X,S as q,u as G,e as V,P as Y,T as Z,X as D}from"./ui-vendor-DKvpuSCb.js";import"./react-vendor-X_fu8xpB.js";import"./AdminLayout-BYuG-4eb.js";import"./transition-CiB-21bZ.js";import"./index-CjLAxSrQ.js";import"./typography-ChUjANkt.js";function he({batch:a,admissions:I,universities:f}){const[_,j]=l.useState(!1),[M,n]=l.useState(!1),[b,y]=l.useState(!1),[J,N]=l.useState(null),[t,z]=l.useState(""),[i,E]=l.useState(""),{data:p,setData:m,post:F,put:B,processing:v,errors:h,reset:w}=C({university_id:"",program_studi:"",count:""}),r=C({file:null}),g=(s=null)=>{s?(y(!0),N(s.id),m({university_id:s.university_id.toString(),program_studi:s.program_studi,count:s.count})):(y(!1),N(null),w()),j(!0)},o=()=>{j(!1),w()},A=s=>{s.preventDefault(),r.post(route("admin.ptn-admissions.batches.import-excel",a.id),{forceFormData:!0,onSuccess:()=>{n(!1),r.reset(),c.success("Import berhasil!")},onError:()=>{c.error("Import gagal. Periksa format file.")}})},L=s=>{s.preventDefault(),b?B(route("admin.ptn-admissions.admissions.update",J),{onSuccess:()=>{o(),c.success("Data berhasil diperbarui")}}):F(route("admin.ptn-admissions.batches.admissions.store",a.id),{onSuccess:()=>{o(),c.success("Data berhasil ditambahkan")}})},U=s=>{confirm("Hapus data ini?")&&W.delete(route("admin.ptn-admissions.admissions.destroy",s),{preserveScroll:!0,onSuccess:()=>c.success("Data berhasil dihapus")})},S=I.filter(s=>{const K=!t||s.program_studi.toLowerCase().includes(t.toLowerCase())||s.university_name.toLowerCase().includes(t.toLowerCase()),$=!i||s.university_id.toString()===i;return K&&$}),O=[{key:"list",label:"Data Penerimaan",description:"Kelola data jumlah penerimaan per jurusan.",icon:P}];return e.jsxs(H,{headerTitle:`${a.name}`,headTitle:`Data ${a.name}`,tabs:O,activeTab:"list",setActiveTab:()=>{},noForm:!0,children:[e.jsx("div",{className:"mb-4",children:e.jsxs(Q,{href:route("admin.ptn-admissions.index"),className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(R,{size:18}),e.jsx("span",{children:"Kembali ke Daftar Batch"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:`px-2.5 py-0.5 font-semibold rounded-full ${a.type==="SNBP"?"bg-blue-100 text-blue-700":a.type==="SNBT"?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"}`,children:a.type}),e.jsxs("span",{children:["Tahun ",a.year]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{size:14})," ",a.total_students," siswa diterima"]})]}),a.description&&e.jsx("p",{className:"mt-3 text-gray-600",children:a.description})]})})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:s=>z(s.target.value),placeholder:"Cari PTN atau jurusan...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-accent-yellow focus:border-accent-yellow"})]}),e.jsxs("select",{value:i,onChange:s=>E(s.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-accent-yellow focus:border-accent-yellow",children:[e.jsx("option",{value:"",children:"Semua PTN"}),f.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{type:"button",onClick:()=>n(!0),className:"!bg-green-600 !text-white hover:!bg-green-700 flex items-center gap-2",children:[e.jsx(G,{size:18})," Import Excel"]}),e.jsxs(d,{type:"button",onClick:()=>g(),className:"!bg-accent-yellow !text-gray-900 hover:!bg-yellow-500 flex items-center gap-2",children:[e.jsx(V,{size:18}),"Tambah Data"]})]})]})}),S.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"PTN"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase",children:"Jurusan / Program Studi"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-500 uppercase",children:"Jumlah"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:S.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"font-medium text-gray-900",children:s.university_name})}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:s.program_studi}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:"px-3 py-1 text-sm font-bold rounded-lg bg-gray-100 text-gray-900",children:s.count})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:()=>g(s),className:"p-2 text-accent-yellow hover:bg-accent-yellow/10 rounded-lg",children:e.jsx(Y,{size:16})}),e.jsx("button",{onClick:()=>U(s.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(Z,{size:16})})]})})]},s.id))})]})}):e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(P,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 mb-4",children:t||i?"Tidak ada data yang sesuai filter":"Belum ada data penerimaan"}),!t&&!i&&e.jsx(d,{onClick:()=>g(),className:"!bg-accent-yellow !text-gray-900",children:"Tambah Data Pertama"})]})]}),e.jsx(T,{show:M,onClose:()=>n(!1),maxWidth:"lg",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-lg w-full mx-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Import Data Excel"}),e.jsx("button",{onClick:()=>n(!1),className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg",children:e.jsx(D,{size:20})})]}),e.jsxs("form",{onSubmit:A,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 text-blue-700 rounded-lg text-sm mb-4",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Panduan Import:"}),e.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[e.jsxs("li",{children:["Format file: ",e.jsx("strong",{children:".xlsx, .csv, atau .pdf"})]}),e.jsxs("li",{children:["Kolom wajib Excel: ",e.jsx("strong",{children:"PTN, Jurusan, Jumlah"})]}),e.jsxs("li",{children:["Format PDF: Teks baris per baris dengan format ",e.jsx("strong",{children:"[Nama PTN] [Nama Jurusan] [Angka Jumlah]"})]}),e.jsx("li",{children:"PTN baru akan otomatis dibuat"})]}),e.jsx("a",{href:route("admin.ptn-admissions.download-template"),target:"_blank",className:"inline-block mt-3 text-blue-600 underline hover:text-blue-800 font-medium",children:"Download Template Excel"})]}),e.jsxs("div",{children:[e.jsx(x,{value:"File Import"}),e.jsx("input",{type:"file",accept:".xlsx, .xls, .csv, .pdf",onChange:s=>r.setData("file",s.target.files[0]),className:`mt-1 block w-full text-sm text-gray-500
                                file:mr-4 file:py-2 file:px-4
                                file:rounded-full file:border-0
                                file:text-sm file:font-semibold
                                file:bg-blue-50 file:text-blue-700
                                hover:file:bg-blue-100`}),e.jsx(u,{message:r.errors.file,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Batal"}),e.jsx(d,{type:"submit",disabled:r.processing,className:"!bg-green-600 !text-white hover:!bg-green-700",children:r.processing?"Mengupload...":"Upload & Import"})]})]})]})}),e.jsx(T,{show:_,onClose:o,maxWidth:"lg",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-lg w-full mx-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:b?"Edit Data":"Tambah Data"}),e.jsx("button",{onClick:o,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg",children:e.jsx(D,{size:20})})]}),e.jsxs("form",{onSubmit:L,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{value:"PTN Tujuan *"}),e.jsxs("select",{value:p.university_id,onChange:s=>m("university_id",s.target.value),className:"w-full mt-1 border-gray-300 rounded-lg shadow-sm focus:border-accent-yellow focus:ring-accent-yellow",children:[e.jsx("option",{value:"",children:"Pilih PTN"}),f.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(u,{message:h.university_id,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(x,{value:"Jurusan / Program Studi *"}),e.jsx(k,{value:p.program_studi,onChange:s=>m("program_studi",s.target.value),placeholder:"Contoh: Teknik Informatika",className:"w-full mt-1"}),e.jsx(u,{message:h.program_studi,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(x,{value:"Jumlah Mahasiswa Diterima (Total per Jurusan) *"}),e.jsx(k,{type:"number",value:p.count,onChange:s=>m("count",s.target.value),placeholder:"0",min:"1",className:"w-full mt-1"}),e.jsx(u,{message:h.count,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Batal"}),e.jsx(d,{type:"submit",disabled:v,className:"!bg-accent-yellow !text-gray-900",children:v?"Menyimpan...":"Simpan"})]})]})]})})]})}export{he as default};
